"use client";

import { useEffect, useRef } from "react";
import gsap from "gsap";
import { ScrollTrigger } from "gsap/ScrollTrigger";

gsap.registerPlugin(ScrollTrigger);

const MaskReveal4 = ({ className }) => {
  const maskPathRef = useRef(null);

  useEffect(() => {
    const path = maskPathRef.current;

    if (!path) return;

    const length = path.getTotalLength();

    // Set up the path for stroke animation
    gsap.set(path, {
      strokeDasharray: length,
      strokeDashoffset: length,
    });

    // Scroll-triggered animation
    gsap.to(path, {
      strokeDashoffset: 0,
      ease: "none",
      scrollTrigger: {
        trigger: path,
        start: "top 80%",
        end: "bottom 20%",
        scrub: true,
        markers: false, // Turn to true for debugging
      },
    });
  }, []);

  const pathData = `M55.856 41.4906C56.6442 41.2385 57.416 40.862 58.2175 40.7537C65.3053 39.8261 72.4304 39.1518 79.482 37.99C85.0056 37.0786 90.4643 35.6793 95.9171 34.3237C102.174 32.7681 108.478 31.3398 114.6 29.2812C120.184 27.4013 125.829 25.4789 130.791 21.8532C131.403 21.4047 132.006 20.9423 132.59 20.4521C135.767 17.7731 134.741 14.784 132.165 12.664C128.842 9.93021 124.895 8.97699 120.936 8.17406C113.411 6.64489 105.821 6.08932 98.2012 5.93607C85.2475 5.6789 72.3562 6.34882 59.4945 7.89966C48.2542 9.25217 37.1881 11.5296 26.269 14.642C20.5878 16.2627 14.9794 18.2214 9.88505 21.5178C8.19528 22.6129 6.6456 24.0899 5.27815 25.6615C3.58614 27.6106 3.86222 29.9521 5.66415 31.8746C8.67359 35.0865 12.4828 36.5886 16.2397 38.1471C23.2325 41.046 30.4718 42.873 37.8073 44.1102C42.0094 44.8158 46.2561 45.1375 50.477 45.6635C51.5041 45.792 52.521 46.032 53.6217 46.2378C48.7691 48.6604 43.7862 47.5021 38.8875 46.9318C31.9832 46.1258 25.1759 44.6046 18.571 42.0624C13.5701 40.1383 8.64514 37.9874 4.42601 34.2727C0.352389 30.6839 1.04794 25.6716 4.3204 22.3932C9.08934 17.6121 15.0584 15.3028 21.1439 13.4106C24.4249 12.3893 27.711 11.382 31.0273 10.5128C34.3354 9.64897 37.6742 8.93272 41.0145 8.24049C41.8293 8.06871 42.704 8.23566 43.1729 8.23997C44.1897 7.93008 44.8986 7.71671 45.6027 7.49399C46.6739 7.16138 47.9003 7.10846 48.8844 7.03217C50.339 6.91667 51.739 5.58898 53.4113 6.61272C54.0418 6.99762 55.1813 6.24586 56.1009 6.10126C58.4508 5.72692 60.8071 5.38594 63.1643 5.05938C65.6922 4.71244 68.2207 4.30758 70.7616 4.09972C72.2888 3.97485 73.8425 4.27281 75.3784 4.21974C76.5326 4.18101 77.6684 3.78163 78.8217 3.72848C80.7036 3.6392 82.5942 3.7568 84.4768 3.67713C85.6774 3.62583 86.9367 3.00162 88.0502 3.27417C90.9712 3.9831 93.8264 3.30206 96.7046 3.32868C100.219 3.35874 103.744 3.48462 107.254 3.7803C115.117 4.43931 123.016 5.00914 130.46 8.44892C131.9 9.11586 133.314 10.0738 134.483 11.2257C138.224 14.9222 137.803 20.1971 133.737 23.3034C128.272 27.4769 122.162 30.017 115.82 31.8578C107.683 34.2213 99.4656 36.2619 91.3061 38.5401C83.6665 40.6746 75.9088 41.9579 68.0378 42.3944C64.4042 42.5937 60.7472 42.3507 57.0964 42.2762C56.7045 42.267 56.3165 42.0454 55.926 41.9203C55.9041 41.777 55.8822 41.6337 55.8603 41.4903L55.856 41.4906Z`; // Truncated for brevity

  return (
    <svg
      className={className}
      width="139"
      height="51"
      viewBox="0 0 139 51"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <defs>
        <mask id="theMask4" maskUnits="userSpaceOnUse">
          <path
            ref={maskPathRef}
            d={pathData}
            stroke="white"
            strokeWidth="4"
            fill="none"
          />
        </mask>
      </defs>

      <g id="maskReveal4" mask="url(#theMask4)">
        <path
          d={pathData}
          stroke="#FFD25D"
          strokeWidth="1.5"
          fill="none"
        />
      </g>
    </svg>
  );
};

export default MaskReveal4;